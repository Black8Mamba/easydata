#ifndef FLASH_KV_CONFIG_H
#define FLASH_KV_CONFIG_H

/*============================================================================
 * Flash 硬件配置 - 根据具体MCU修改
 *============================================================================*/

/* Flash 块大小 (擦除最小单位) 单位：字节 */
#define FLASH_KV_BLOCK_SIZE         2048

/* Flash 写入单位 (字节对齐要求) */
#define FLASH_KV_WRITE_SIZE        8

/* Flash 读取单位 */
#define FLASH_KV_READ_SIZE         1

/*============================================================================
 * KV 存储配置
 *============================================================================*/

/* Key 长度 (字节) */
#define FLASH_KV_KEY_SIZE          32

/* Value 长度 (字节) */
#define FLASH_KV_VALUE_SIZE        64

/* 每条记录总大小 = Key + Value + Meta(4) + CRC16(2) */
#define FLASH_KV_RECORD_SIZE       (FLASH_KV_KEY_SIZE + FLASH_KV_VALUE_SIZE + 4 + 2)

/* 最大记录条数 */
#define FLASH_KV_MAX_RECORDS       512

/*============================================================================
 * Flash 空间配置
 *============================================================================*/

/* Flash 起始地址 */
#define FLASH_KV_START_ADDR        0x0800F000

/* Flash 总大小 (字节) */
#define FLASH_KV_TOTAL_SIZE        (32 * 1024)

/*============================================================================
 * GC 配置
 *============================================================================*/

/* GC 触发阈值：空闲空间小于此值时触发 (百分比 0-100) */
#define FLASH_KV_GC_THRESHOLD     20

/*============================================================================
 * 哈希表配置
 *============================================================================*/

/* 哈希表大小 (必须是2的幂) */
#define FLASH_KV_HASH_SIZE        1024

/*============================================================================
 * 线程安全配置
 *============================================================================*/
#define FLASH_KV_THREAD_SAFE       0

/*============================================================================
 * 写入重试配置
 *============================================================================*/
#define FLASH_KV_WRITE_RETRY_MAX   3
#define FLASH_KV_WRITE_RETRY_DELAY_MS  10

/*============================================================================
 * 多实例支持
 *============================================================================*/
#define FLASH_KV_INSTANCE_MAX      2

#endif /* FLASH_KV_CONFIG_H */
